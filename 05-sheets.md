# 第5章 Googleスプレッドシートの操作方法

Googleスプレッドシートはいわゆる表計算アプリケーションで、機能面、操作面ともにMicrosoft Excel（以下Excel）と類似した点も多いアプリケーションです。
ただし、GoogleスプレッドシートはWebブラウザー上で動作するため、ショートカット・キーなど、Excelとは異なる点も多々あります。

Googleスプレッドシートには、<https://sheets.google.com/>からアクセスできます。
このページには、最近利用したスプレッドシートの一覧などが表示されますが、実際の利用に当たってはGoogleドライブからスプレッドシートを開いたり新規作成をしたりする方が便利な場合が多いでしょう。

## 画面の構成

Googleスプレッドシートの画面は、主に以下の要素から構成されています。

* メニューバー
* ツールバー
* シート編集領域
* シートタブ

以下、それぞれの要素について説明します。

### メニューバー

画面上部に表示されていて、「ファイル」、「編集」、「表示」などのメニューが並んでいます。
Alt + Fを押下すると、ファイル・メニューにフォーカスが移り、左右矢印キーで他のメニューに移動することもできます。
上下矢印キーで、そのメニューの中の項目を選択できます。

### ツールバー

ツールバーは、メニューバーの下に表示されていて、よく使う機能のアイコンが並んでいます。
ほとんどの機能はメニューバーから実行したりショートカット・キーを使って実行したりすることができます。

ツールバーのアイコンを利用する場合は、まずメニューバーにフォーカスを移した後にTabキーを押下して、ツールバーにフォーカスを移してください。
その上で、左右矢印キーでアイコンを選択し、Enterキーで実行できます。

### シート編集領域

シート編集領域は、画面の中央部分に表示されている、表計算のためのエリアです。
縦横にセルが並び、各セルにはアルファベットと数字で表されるセル番地が割り当てられています。
セル番地はExcelと同様で、アルファベットで列、数字で行を表します。
左上端のセルがA1で、A1の右隣がB1、A1の下がA2です。

新規作成したスプレッドシートや、新規に追加したシートの場合、セルA1に新しい機能に関する説明などが入力された状態になっていることがあります。
また、この内容が一定時間ごとに自動的に更新される場合があり、この場合はNVDAがその度にその内容を読み上げて煩わしく感じるかもしれません。
セルA1の内容が不要であることを確認した上で、削除するとよいでしょう。

### シートタブ

シートタブは、そのファイルのシート一覧が表示されている画面下部の領域です。
複数のシートがあるファイルの場合は、シートの切り替えやシートの並び順の変更などの操作をここから行います。

キーボードで操作する場合は、後述するシートメニューやシートリストを利用することで、同等の操作が可能です。

## 基本的な操作

ここでは、利用することが多い操作について説明します。

### シート内の移動

矢印キーを使って、1セルずつ矢印の方向にセル間を移動することができます。

Ctrl + 矢印キーを押下すると、以下のように移動します。

* 現在のセルが空白の場合：矢印の方向の次の空白ではないセルに移動
* 現在のセルが空白ではない場合：矢印の方向の次の空白のセルの直前のセルに移動

また、以下のショートカット・キーも利用できます。

* Homeキー：行の先頭のセルに移動
* Endキー：行の末尾のセルに移動
* Ctrl + Homeキー：シートの先頭のセル（A1）に移動
* Ctrl + Endキー：シートの末尾のセルに移動

Page UpキーやPage Downキーを押下すると、画面の上下方向にスクロールします。
まとまった行数を移動する場合には便利ですが、この操作で移動するのは1画面に表示されている行数です。
1画面に表示される行数は、ウィンドウのサイズ、行の高さ、ズームの状態など様々な要因で変わるため、いつも同じ行数を移動できるわけではないことに注意してください。

Ctrl + Jを押下して表示されるダイアログにセル番地を入力すると、そのセルに移動できます。
また、このダイアログには、後述する名前付き範囲の名前を入力して移動することもできます。

### ポップアップ

セル内にリンクがある場合など、ポップアップが表示されることがあります。
Googleドキュメント同様、Ctrl + Alt + E Ctrl + Alt + Pの押下でポップアップにフォーカスを移し、Tabキーでポップアップ内の項目に移動できます。

### セルの編集

編集したいセルにカーソルを移動した上で、F2キーまたはEnterキーを押下すると、そのセルが編集モードになります。
入力中にCtrl + Enterを押下すると、改行が入力されます。

入力中に@（アットマーク）を入力すると、Googleドキュメントの項で紹介したスマートチップを挿入できます。

Escキーを押下すると、編集を中止して、セルの内容は編集前の状態に戻ります。

編集内容を確定するには、以下のいずれかのキーを押下します。

* Enterキー：編集内容を確定して、下のセルに移動
* Shift + Enterキー：編集内容を確定して、上のセルに移動
* Tabキー：編集内容を確定して、右のセルに移動
* Shift + Tabキー：編集内容を確定して、左のセルに移動

### セルの選択

まず、カーソルがあるセルは選択された状態になっています。

Shiftキーを押しながら矢印キーを押下すると、複数のセルを選択することができます。
また、Ctrl + 矢印キーや、Page Up、Page DownキーとShiftキーを組み合わせることで、複数のセルを選択することもできます。

Shift + Spaceを押下すると、現在の行が選択されます。
Ctrl + Spaceを押下すると、現在の列が選択されます。

行や列の選択は、厳密には2段階に分けて行われます。
例えば、A1からZ100までのセルがある100行×26列のシートを仮定します。
そして実際にデータが入力されているのは、A1からF50までの50行×6列の範囲だとします。
このとき、A1にカーソルがある状態でShift + スペースキーを押下して行選択を実行をすると、まずA1からF1が選択状態になります。
再度Shift + スペースキーを押下すると、A1からZ1までが選択状態になります。

### セルのコピー、切り取りと貼り付け

選択されているセルのコピーや切り取りは、それぞれCtrl + CとCtrl + Xの押下で可能です。
また、CTRL + Vの押下で、コピーまたは切り取りしたセルを貼り付けることができます。

### セルのクリアと削除

選択されているセルの内容をクリアするには、Deleteキーを押下します。
この操作では、セルの内容が削除されるだけで、セルそのものは削除されません。

選択されているセルを削除するには、コンテクスト・メニューから「セルを削除」を実行します。
「セルを削除」にはサブメニューがあり、削除した後に残ったセルの扱いを指定します。

行や列の削除は、削除したい行や列に含まれるセルにカーソルを移動した上で、コンテクスト・メニューから行います。
連続する複数のセルを選択した状態で実行すれば、複数の行や列をまとめて削除できます。

### シートの追加

メニューバーから「挿入」→「シート」の順に選択すると、新しいシートが追加されます。
また、ショートカット・キーShift + F11を押下することでも新しいシートを追加できます。
追加されたシートは、現在表示されているシートの直後（シートタブでは右隣）に追加されます。

### シートの切り替え

複数のシートがあるファイルの場合、Alt + 上矢印キーまたはAlt + 下矢印キーを押下することで、前後のシートに移動できます。
また、Alt + Shift + Kを押下すると、シート一覧が表示されるので、そこから移動先のシートを選択してEnterキーを押下することでも移動できます。

### シートに対するその他の操作

Alt + Shift + Sを押下すると、シートに関する操作を行うことができるメニューが表示されます。
このメニューから、シートの削除、並べ替え、名前の変更、複製、他のスプレッドシートへのコピーなどを実行できます。

### 数式と関数

編集中のセルの冒頭で=（イコール）を入力すると、数式モードになります。
数式モードでは、セル番地を用いた四則計算や関数の利用が可能です。

関数やその引数をすべて手動で入力することももちろん可能ですが、Googleスプレッドシートには関数の入力支援機能があります。

数式モードで関数名の冒頭部分を入力すると、関数の候補が、簡単な説明とともに表示されます。
上下矢印キーで候補のリスト内を移動し、Enterキーで入力する関数を決定できます。

関数を決定すると、引数を入力できる状態になります。
ここでF1キーを押下すると、そこで入力すべき引数についてのヘルプが読み上げられます。
必要に応じてヘルプを参照し、引数を入力したら、,（カンマ）を入力して次の引数を入力します。
最後の引数を入力したら、EnterキーやTabキーなど、セルから離れる操作をすると、自動的に引数リストの末尾の閉じカッコが入力され、セルの内容が確定します。
または、手動で閉じカッコを入力して、さらに別の関数などの入力を続けることもできます。

引数としてセル範囲を入力する場合、<シート名>!<開始セル>:<終了セル>の形式で記述します。
シート名を省略すると、現在のシートが対象になります。
開始セルはセル範囲の左上の角のセル、終了セルは右下の角のセルをそれぞれ指定します。
終了セルを省略すると、1つのセルだけを含む範囲を指定したことになります。

引数としてセル範囲を指定する際、もちろん手動で入力してもまったく問題はありませんが、矢印キーなどを使って指定したい範囲を選択する方法もあります。
例えば、A5からA9の値の合計をA10に入力したい場合、以下のように操作します。

1. A10にカーソルを移動
2. =（イコール）を入力して数式モードにする
3. suと入力すると、suから始まる名前の   関数が候補として表示される
4. 上下矢印キーで「SUM 一連の数値またはセルの合計」と読み上げられるものを探してEnter
5. 上矢印キーを1度押下してA9に移動
6. Shift + 上矢印キーを使ってA5まで選択（A4が空白の場合は、Ctrl + Shift + 上矢印キーの押下でA5まで選択できる）
7. EnterキーやTabキーを押下してセルA10の内容を確定

もしA5:A9という範囲を正確に覚えていれば、上記手順の5と6の代わりに直接「A5:A9」と入力した方が早いですが、範囲が大きい場合や、範囲を覚えていない場合には、矢印キーを使って範囲を選択する方法が便利です。

### 名前付き範囲

上記のSUM関数の例では、A5:A9という範囲をセル番地で指定していますが、この範囲に名前を付けることで、セル番地の代わりにその名前を用いて範囲を指定できます。

名前を付けたいセル範囲を選択した上で、コンテクスト・メニューから以下の順に選択すると、名前付き範囲を定義するためのダイアログが表示されます。

セルでの他の操作項目を表示→名前付き範囲を定義

選択されているセルが1つだけの場合は、「範囲を追加」と読み上げられる箇所にフォーカスが移動しますので、ここでEnterキーを押下します。
（複数のセルが選択されている場合は、「範囲を追加」を押した後の状態になります。）
範囲に付ける名前を入力する欄にフォーカスが移動するので、ここに名前を入力します。
Tabキーを押下すると、対象となっている範囲の指定が入力された状態の絵デット・ボックスにフォーカスが移動しますので、必要に応じて範囲指定を確認します。
何度かTabキーを押下して「完了」にフォーカスを移動してから、Enterキーを押下すると、名前付き範囲が定義されます。

定義が終わったら、Escキーを押下してダイアログを閉じます。

このダイアログは、メニューバーから「データ」→「名前付き範囲」の順に選択して表示することもできます。
このダイアログには、新しい名前付き範囲の定義のためのボタンだけでなく、既存の名前付き範囲のリストも表示されていて、これらの削除や変更を行うこともできます。

## データの活用

Googleスプレッドシートには、データを活用するための様々な機能が用意されています。
ここでは、まずデータのインポートについて説明します。
その上で、使われることが多い、フィルタ、ピボットテーブルについて紹介します。

### データのインポート

Googleスプレッドシートには、CSV、TSV、XLSXなどのファイルをインポートする機能があります。
メニューバーから「ファイル」→「インポート」の順に選択すると、インポートのためのダイアログが表示されます。

ダイアログが表示された時点では、Googleドライブの内容が表示されています。
このダイアログの先頭に近い箇所には、Googleドライブ内を検索するための検索ボックスがあります。
NVDAでブラウズ・モードに一旦切り替えて、Eキーを使ってこの検索ボックスを探し、操作の起点とすると分かりやすいかもしれません。

インポートしたいファイルがGoogleドライブ上にある場合は、この検索ボックスを活用すると便利かもしれません。
ファイル名を入力してEnterキーを押下すると、検索結果が表示されます。
何度かTabキーを押下すると検索結果のリストにフォーカスが移動します。
なおこの表示はギャラリー表示になっていますので、上下矢印キーだけでなく、左右矢印キーも使って確認する必要があります。

検索欄の下には、「マイドライブ」、「共有アイテム」、「最近使用したアイテム」、「アップロート」のタブからなるタブ表示があります。
手元のファイルをインポートする場合は、「アップロード」タブを選択してEnterキーを押下します。
Tabキーの押下で「参照」ボタンにフォーカスを移動し、Enterキーを押下します。
ファイル選択のダイアログが表示されますので、目的のファイルを選択します。

ファイルを選択すると、インポート先やファイルの形式に応じた設定項目が表示されますので、適宜調整した上で「データをインポート」を押します。

### フィルタ

Googleスプレッドシートには、フィルタとフィルタビュー（フィルタ表示）という機能があります。
どちらも、データの中から特定の条件に合致する行だけを表示するための機能です。
この2つの機能の違いは、以下の通りです。

* フィルタ：条件に合致する行を抽出し、その結果を表示すると同時にファイルにも反映し、すべての共同編集者に影響する
* フィルタビュー：条件に合致する行を抽出し、その結果を表示するが、ファイルには反映されず、自分だけがその結果を見ることができる

フィルタを作成するには、メニューバーから「データ」→「フィルタを作成」の順に選択します。
また、フィルタビューを作成するには、「データ」→「フィルタびゅうを作成」の順に選択します。

このいずれかの操作をすると、対象の領域の先頭行（多くの場合は1行目）の各セルにフィルタの条件などを指定するためのプルダウンが表示されます。
このようなセルにカーソルが移動すると、「フィルタのプルダウンがあります」と読み上げられます。
フィルタのプルダウンがあるセルでは、Ctrl + Alt + Rの押下で、このプルダウンにアクセスできます。

フィルタのプルダウンは、操作感はダイアログに近いものです。
このプルダウンは、大きく「条件でフィルタ」と「値でフィルタ」の2つのセクションから構成されています。
プルダウンにフォーカスが移動してから、1度Tabキーを押下すると「条件でフィルタ」のセクションにフォーカスが移動します。
この時点ではこのセクションは折りたたまれています。
そのままさらにTabキーを押下すると、「値でフィルタ」のセクションにフォーカスが移動します。
このセクションは開いた状態になっています。

これらのセクションは、Enterキーの押下で開閉します。
セクションが開いているときは、Tabキーの押下でそのセクション内の項目に移動します。

#### 条件でフィルタの操作例

条件でフィルタのセクションでは、条件の種類をリストから選択すると、その条件に関する指定を入力するための入力欄が表示されます。
例えば、数値が入力されている列で、その値が51以上、75以下の範囲にある行だけを表示したい場合、以下のように操作します。

1. 対象の列の列見出しに移動
2. Ctrl + Alt + Rを押下してフィルタのプルダウンを表示
3. Tabキーを押下して「条件でフィルタ」のセクションにフォーカスを移動
4. 「条件でフィルタタブ 選択 折りたたみ」と読み上げられるので、Enterキーを押下して開く
5. Tabキーを押下して、条件のリストに移動
6. 上下矢印キーを使って「次の間にあるを選択してEnterキーを押下
7. Tabキーを押下して、下限の入力欄に移動
8. 51と入力
9. Tabキーを押下して、上限の入力欄に移動
10. 75と入力
11. Tabキーを何度か押下して「OK」にフォーカスを移動
12. Enterキーを押下してフィルタを適用

なお、上記手順の11で、Tabキーを1度押下して「値でフィルタタブ 選択 展開」と読み上げられたところでEnterキーを押下すると、値でフィルタに関連する項目が非表示になり、OKに到達するためにTabキーを押下する回数を減らすことができます。

条件でフィルタでは、「カスタム数式」を選択すると、条件を自由に指定できる入力欄が表示されます。
複雑な条件を指定する場合には、この機能を使うと便利です。

#### 値でフィルタの操作例

値でフィルタのセクションでは、リストから選択することで、その値を持つ行だけを表示することができます。
例えば、「はい」、「いいえ」、「どちらでもない」という選択肢から選んで回答してもらった結果が入力されている列で、「はい」と回答した行だけを表示したい場合、以下のように操作します。

1. 対象の列の列見出しに移動
2. Ctrl + Alt + Rを押下してフィルタのプルダウンを表示
3. Tabキーを押下して「値でフィルタ」のセクションにフォーカスを移動（値でフィルタのセクションは開かれた状態になっているはずなので、「値でフィルタタブ 選択 展開」と読み上げられる）
4. Tabキーを2度押下して「クリア」にフォーカスを移動
5. Enterキーを押下して、すべての項目の選択を解除
6. Tabキーを押下して、選択肢のリストに移動
7. 上下矢印キーで表示に含めたい項目（この例では「はい」）を探してEnterキーを押下（正しく選択されると「はい チェック」と読み上げられる）
8. Tabキーを何度か押下して「OK」にフォーカスを移動
9. Enterキーを押下してフィルタを適用

### ピボットテーブル

ピボットテーブルは、Googleスプレッドシートでデータを効率的に分析するための強力なツールです。
複雑なデータセットから特定の傾向や要約情報を比較的簡単な操作だけで抽出でき、項目のグループ化や合計、平均、最大値などの計算を行えます。

ピボットテーブルは、以下の手順で作成できます。

1. メニューバーから「挿入」→「ピボットテーブル」の順に選択して、ピボットテーブルの作成ダイアログを表示
2. Tabキーを押下して「データ範囲」の欄にフォーカスを移動し、記入されている内容を確認、必要に応じて修正（集計の対象とするデータが含まれる範囲を指定します）
3. Tabキーを押下して「挿入先」の欄にフォーカスを移動し、ピボットテーブルの出力先を指定（初期値は「新しいシート」）
4. 既存のシートに出力したい場合は、下矢印キーを押下（「既存のシート」が選択され、出力先を入力する欄にフォーカスが移動します）
5. <シート名>!<セル番地>
の形式で、作成されるピボットテーブルの左上のセルの出力先を指定
6. Tabキーを押下して「作成」にフォーカスを移動し、Enterキーを押下

以上の操作を行うと、ピボットテーブルが作成され、ピボットテーブルの編集画面に移動します。
編集画面では、行、列、値、フィルタの各項目に対して、集計方法や表示形式、ソートの方法などを設定できます。
設定が終わったら、Escキーを押下して編集画面を閉じます。

ピボットテーブルの列見出しや行見出しを選択してコンテクスト・メニューを表示すると、日付によるグループ化など、さらに細かな操作が可能な場合があります。

既存のピボットテーブルの設定変更は、以下の手順で行います。

1. ピボットテーブルが表示されている範囲内のセルにカーソルを移動
2. メニューバーから「ユーザー補助機能」→「編集コントロールにフォーカスを移動」の順に選択（ショートカット・キーは Alt + A F）
3. 「ピボットテーブルを編集」というボタンにフォーカスが移動するので、Enterキーを押下
4. ピボットテーブルの編集画面が表示される

#### ピボットテーブル操作例

以下のサンプルデータを使って、操作方法の例を紹介します。

|    日付    |     商品名     | カテゴリ | 売上金額 |  地域  |
| :--------- | :------------- | :------- | -------: | :----- |
| 2024/11/01 | スマートフォン | 家電     |    50000 | 東京   |
| 2024/11/02 | 書籍           | 書籍     |     1500 | 大阪   |
| 2024/12/01 | ヘッドホン     | 家電     |    10000 | 福岡   |
| 2024/12/02 | スマートフォン | 家電     |    50000 | 名古屋 |
| 2025/01/01 | 書籍           | 書籍     |     1500 | 東京   |
| 2025/01/02 | ヘッドホン     | 家電     |    10000 | 大阪   |

まず、このデータが表示されているシートで、メニューバーから「挿入」→「ピボットテーブル」を選択して、ピボットテーブルの作成ダイアログを表示します。
このデータのみが含まれているシートであれば、データ範囲は自動的にA1:E7に設定されるはずです。
挿入先には「新しいシート」が選択されているので、そのまま「作成」を押下します。

以下の手順で、日付ごと、地域ごとの売り上げを表示するピボットテーブルを作成します。

1. ピボットテーブルの編集画面を表示
2. Tabキーで「行 追加」にフォーカスを移動し、Enterキーを押下
3. 上下矢印キーで「日付」を選択してEnterキーを押下
4. Tabキーで「列 追加」にフォーカスを移動し、Enterキーを押下
5. 上下矢印キーで「地域」を選択してEnterキーを押下
6. Tabキーで「値 追加」にフォーカスを移動し、Enterキーを押下
7. 上下矢印キーで「売上金額」を選択してEnterキーを押下
8. Escキーを押下して編集画面を閉じる

出力されたピボットテーブルの、「2024/11/01」のような日付が記入されているセルを選択してコンテクスト・メニューを表示すると、「ピボット日付グループを作成」という項目があります。
このサブメニューの中から「年-月」を選択すると、月ごと、地域ごとの集計に変更されます。

行、列、値に指定する値を変更することで、さまざまな集計が可能です。

## ショートカット・キーの注意点

Googleスプレッドシートには、Excelと同様のショートカット・キーが多く提供されていますが、デフォルトでは無効になっているものもあります。

ショートカット・キーの一覧（Ctrl + /）の末尾にある「スプレッドシートの互換ショートカットを有効にする」が選択された状態にすると、Excelと同様のショートカット・キーが有効になります。
ただし、この設定が有効になっているときは、メニューバーに移動するショートカット・キーが変わりますので注意が必要です。
具体的には、例えばファイル・メニューへの移動はAlt + Fではなく、Alt + Shift + Fになります。

ショートカット・キーの一覧に表示されているExcel互換のショートカット・キーは、例えば「Alt+I,M」のように記述されています。
この記述は、Altキーを押したままIキーとMキーを続けて押下するという意味で、このガイドでの記述方針やGoogle Workspaceの他のアプリケーションでの記述とは異なりますので注意が必要です。

Excelを使い慣れている場合は、この設定を有効にしておくと便利かもしれませんが、そうでない場合は、無効にしておいた方が使いやすいかもしれません。
